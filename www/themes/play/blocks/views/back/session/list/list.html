<div class="container-fluid">
  <div class="row">
    <div class="col-md-12 main">
      <h1 class="page-header"></h1>
      <h2 class="sub-header">
        場次管理
        <span>
          <a href="#" onclick="<%=ctrl%>.showInfo('undefined');"><i class="glyphicon glyphicon-plus-sign"></i></a>
        </span>
        <span>
          <button type="button" class="btn btn-default pull-right" onclick="<%=ctrl%>.doLogout();">logout</button>
        </span>
      </h2>
      <div class="table">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>梯次</th>
              <th>日期</th>
              <th>時間</th>
              <th>場次</th>
              <th>地址</th>
              <th>功能</th>
            </tr>
          </thead>
          <tbody>
            <% if (value && value.list.length > 0) {
               value.list.reverse().forEach(function(item) {
                 function date(target) {
                   var t = new Date(item[target]);
                   var time = t.toLocaleTimeString().substring(0, 5);
                   var rtn = t.getFullYear() +'-'+ ('0'+(t.getMonth()+1)).slice(-2) +'-'+ ('0'+t.getDate()).slice(-2) + ' ' + time;
                   return rtn;
                 }
                 var sTime = new Date(item.fromTime),
                     eTime = new Date(item.toTime),
                     period = sTime.getHours() + ":" + sTime.getMinutes() + "-" + eTime.getHours() + ":" + eTime.getMinutes("mm"),
                     period = date('fromTime').substring(11, 16) + ' - ' + date('toTime').substring(11, 16)
                     onTime = new Date(item.regFromTime),
                     offTime = new Date(item.regToTm),
                     now = new Date(),
                     open = (now < offTime) ? true : false;


            %>
            <tr>
              <td><%= item.doc.title %></td>
              <td><p class="truncate"><%= item.doc.summary %></p></td>
              <td><%= period %></td>
              <td><%= item.doc.body %></td>
              <td><p class="truncate"><%= item.addr %></p></td>
              <td>
                <button class="btn btn-default" onclick="<%=ctrl%>.showInfo('<%=item.siID%>');">編輯</button>
                <a href="/back/attendee/list/<%=item.siID%>"><button class="btn btn-primary">報名管理</button></a>
                <button class="btn btn-danger" onclick="<%=ctrl%>.delete('<%=item.siID%>');">刪除</button>
              </td>
            </tr>
            <% });
             } %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="myModal" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <!-- block /back/session/info -->
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
